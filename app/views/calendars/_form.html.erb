<div class="schedule-type-selection">
  <%= f.radio_button :schedule_type, "timed", id: "schedule_type_timed", checked: true %>
  <%= f.label :schedule_type_timed, "æ™‚é–“æŒ‡å®š" %>

  <%= f.radio_button :schedule_type, "all_day", id: "schedule_type_all_day" %>
  <%= f.label :schedule_type_all_day, "çµ‚æ—¥" %>
</div>

<!-- çµ‚æ—¥ -->
<div id="all-day-fields" style="display: none;">
  <div class="form-group">
    <%= f.label :start_time, 'é–‹å§‹æ—¥' %>
    <%= f.date_field :start_time, value: (f.object.start_time || params[:date] || Date.today).to_date.strftime("%Y-%m-%d") %>
  </div>
  <div class="form-group">
    <%= f.label :end_time, 'çµ‚äº†æ—¥' %>
    <%= f.date_field :end_time, value: (f.object.end_time || params[:date] || Date.today).to_date.strftime("%Y-%m-%d") %>
  </div>
</div>

<!-- æ™‚é–“æŒ‡å®šã€€-->
<div id="timed-fields">
  <div class="form-group">
    <%= f.label :start_time, 'é–‹å§‹æ—¥æ™‚' %>
    <%= f.datetime_local_field :start_time, class: 'form-control', value: (f.object.start_time || params[:datetime] || Time.current).strftime("%Y-%m-%dT%H:%M") %>
  </div>
  <div class="form-group">
    <%= f.label :end_time, 'çµ‚äº†æ—¥æ™‚' %>
    <%= f.datetime_local_field :end_time, class: 'form-control', value: (f.object.end_time || params[:datetime] || (Time.current + 30.minutes)).strftime("%Y-%m-%dT%H:%M") %>
  </div>
</div>
<div>
  <%= f.label :name, "ä»¶å" %>
  <%= f.text_field :name, placeholder: t("views.greeting.enter"), class: "w-full px-4 py-2 bg-light-gray/75 text-matcha rounded-lg focus:outline-none focus:ring-2 focus:ring-matcha" %>

  <%= f.label :source, "calendar_type", class: "text-dark-gray" %>
  <%= f.select :source,
    [["ã‚°ãƒ¼ã‚°ãƒ«", "google"], ["ãƒãƒ‹ãƒ¥ã‚¢ãƒ«", "manual"]],
    { prompt: "é¸ã‚“ã§ãã ã•ã„" }, class: "bg-matcha/65 text-beige py-2 pl-3 pr-10 rounded w-full focus:ring-2 focus:ring-matcha"
  %>

  <%= f.label :description, "note", class: "text-dark-gray" %>
  <%= f.text_field :description, placeholder: "note", class: "w-full px-4 py-2 bg-light-gray/75 text-matcha rounded-lg focus:outline-none focus:ring-2 focus:ring-matcha" %>

  <%= f.label :category, "category", class: "text-dark-gray" %>
  <%= f.select :category,
    [["ç”¨äº‹ãƒ»ãã®ä»–", "event"], ["ä»•äº‹ãƒ»å‹‰å¼·", "work_study"],["ãƒªãƒ©ãƒƒã‚¯ã‚¹", "relax"]],
    { prompt: "é¸ã‚“ã§ãã ã•ã„" }, class: "bg-matcha/65 text-beige py-2 pl-3 pr-10 rounded w-full focus:ring-2 focus:ring-matcha"
  %>

  <%= f.label :visibility, "é–²è¦§æ¨©é™", class: "text-dark-gray" %>
  <%= f.select :visibility,
    [["ğŸ”’éå…¬é–‹", "personal"], ["å…±æœ‰ã®ã¿", "share_only"],["ä¸€ç·’ã®äºˆå®š", "together"]],
    { prompt: "é¸ã‚“ã§ãã ã•ã„" }, class: "bg-matcha/65 text-beige py-2 pl-3 pr-10 rounded w-full focus:ring-2 focus:ring-matcha"
  %>
</div>
<div class="text-center">
  <%= f.submit t("buttons.save"), class: "bg-blue/75 text-dark-gray py-2 px-6 rounded hover:bg-blue/30 transition duration-200 mt-2", data: { turbo: false } %>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const timedRadio = document.querySelector('#schedule_type_timed');
    const allDayRadio = document.querySelector('#schedule_type_all_day');

    const timedFields = document.getElementById('timed-fields');
    const allDayFields = document.getElementById('all-day-fields');

    function toggleFields() {
      const isAllDay = allDayRadio.checked;

      timedFields.style.display = isAllDay ? 'none' : 'block';
      allDayFields.style.display = isAllDay ? 'block' : 'none';

      // å„ input ã‚’æœ‰åŠ¹ãƒ»ç„¡åŠ¹åŒ–
      allDayFields.querySelectorAll('input').forEach(input => {
        input.disabled = !isAllDay;
      });
      timedFields.querySelectorAll('input').forEach(input => {
        input.disabled = isAllDay;
      });
    }

    timedRadio.addEventListener('change', toggleFields);
    allDayRadio.addEventListener('change', toggleFields);

    toggleFields(); // åˆæœŸåŒ–
  });
</script>