<div class="mb-6 mt-6">
  <div class="text-dark-gray">
    <h1>*Tips„ÇÑË≥™Âïè„ÇíÊäïÁ®ø„Åó„Å¶„Åø„Çà„ÅÜ</h1>
    <%= form_with model: @post, local: true, class: "max-w-md mx-auto p-6 bg-light-gray/50 rounded-2xl shadow-lg mt-2" do |f| %>
      <% if @post.errors.any? %>
        <div class= "bg-beige/30 text-matcha/75 font-bold">
          <ul class="list-disc pl-5">
            <% @post.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <%= f.label :relationship, "ÈñìÊüÑ", class: "text-dark-gray" %>
      <div class="space-y-2">
      <%= f.select :relationship,
          [["‰∫§ÈöõÁõ∏Êâã„ÄÅ„Éë„Éº„Éà„Éä„Éº", "partner"], ["ÂèãÈÅî", "friend"], ["ÂÆ∂Êóè", "family"], ["„Åù„ÅÆ‰ªñ", "other_relationship"]],
          { prompt: "ÈñìÊüÑ„ÇíÈÅ∏Êäû" }, class: "bg-matcha/65 text-beige py-2 pl-3 pr-10 rounded w-full focus:ring-2 focus:ring-matcha", id: "relationship-select" %>
      <div id="custom-relationship-field" style="display: none;" class="mt-2">
        <%= f.label :custom_relationship, "Ëá™Áî±Ë®òËø∞Ôºà„Åù„ÅÆ‰ªñÔºâ", class: "text-dark-gray" %>
        <%= f.text_field :custom_relationship,placeholder: "ÈñìÊüÑ„ÇíÂÖ•Âäõ", class: "w-full px-4 py-2 bg-light-gray/75 text-matcha rounded-lg focus:outline-none focus:ring-2 focus:ring-matcha" %>
      </div>

      <%= f.label :post_type, "tips/Ë≥™Âïè", class: "text-dark-gray" %>
      <%= f.select :post_type,
          [["Tips", "tips"], ["Ë≥™Âïè", "question"]],
          { prompt: "tips/Ë≥™Âïè„ÇíÈÅ∏Êäû" }, class: "bg-matcha/65 text-beige py-2 pl-3 pr-10 rounded w-full focus:ring-2 focus:ring-matcha" %>

      <%= f.label :situation, "Áä∂Ê≥Å", class: "text-dark-gray" %>
      <%= f.select :situation,
          [["ÈÅ†Ë∑ùÈõ¢", "long_distance"], ["„Åü„Åæ„Å´‰ºö„ÅÜ", "sometimes_meet"], ["ÂêåÂ±Ö", "living_together"], ["„Åù„ÅÆ‰ªñ", "other_situation"]],
          { prompt: "Áä∂Ê≥Å„ÇíÈÅ∏Êäû" }, class: "bg-matcha/65 text-beige py-2 pl-3 pr-10 rounded w-full focus:ring-2 focus:ring-matcha", id: "situation-select" %>
      <div id="custom-situation-field" style="display: none;" class="mt-2">
        <%= f.label :custom_situation, "Ëá™Áî±Ë®òËø∞Ôºà„Åù„ÅÆ‰ªñÔºâ", class: "text-dark-gray" %>
        <%= f.text_field :custom_situation,placeholder: "Áä∂Ê≥Å„ÇíÂÖ•Âäõ", class: "w-full px-4 py-2 bg-light-gray/75 text-matcha rounded-lg focus:outline-none focus:ring-2 focus:ring-matcha" %>
      </div>

      <%= f.label :content, "ÂÜÖÂÆπ", class: "text-dark-gray" %>
      <%= f.text_area :content, placeholder: "ÂÜÖÂÆπ„ÇíÂÖ•Âäõ", class: "w-full px-4 py-2 bg-light-gray/75 text-matcha rounded-lg focus:outline-none focus:ring-2 focus:ring-matcha" %>

      <%= f.label :display_name, "Ë°®Á§∫Âêç", class: "text-dark-gray" %>
      <%= f.select :display_name,
          [["#{current_user.name}", "username"], ["ÂåøÂêç", "anonymous"], ["Ë°®Á§∫ÂêçÁôªÈå≤", "nickname"]],
          { prompt: "Ë°®Á§∫Âêç„ÇíÈÅ∏Êäû" }, class: "bg-matcha/65 text-beige py-2 pl-3 pr-10 rounded w-full focus:ring-2 focus:ring-matcha", id: "name-select" %>
      <div id="custom-name-field" style="display: none;" class="mt-2">
        <%= f.label :custom_name, "Ëá™Áî±Ë®òËø∞Ôºà„Åù„ÅÆ‰ªñÔºâ", class: "text-dark-gray" %>
        <%= f.text_field :custom_name,placeholder: "Ë°®Á§∫Âêç„ÇíÂÖ•Âäõ", class: "w-full px-4 py-2 bg-light-gray/75 text-matcha rounded-lg focus:outline-none focus:ring-2 focus:ring-matcha" %>
      </div>

      <div class="text-center">
        <%= f.submit "Êõ¥Êñ∞", class: "bg-blue/75 text-dark-gray py-2 px-6 rounded hover:bg-blue/30 transition duration-200 mt-2", data: { turbo: false } %>
      </div>
      <%= link_to '<i class="fa-solid fa-trash text-lg text-blue"></i>'.html_safe, @post, data: { turbo_method: :delete, turbo_confirm: t("flash.alert")} %>
    <% end %>
    <div class ="text-center title ">
        <%= link_to 'share', "https://x.com/share?url=https://our-onlineroom.com/&text=„Äêüè†#{@post.post_type}„ÄëÔΩû#{@post.content}ÔΩû„ÇíÊäïÁ®ø„Åó„Åæ„Åó„ÅüÔºÅ", 
        title: 'X',class:'fa-brands fa-x-twitter', target: '_blank', rel: "noopener" %>
    </div>
  </div>
</div>
<div class="flex justify-center">
    <div class="w-full">
        <h1 class="text-3xl font-bold text-dark-gray"><%= "„Ç≥„É°„É≥„Éà" %></h1>
            <% if @post.answers.empty? %>
              <p>„Ç≥„É°„É≥„Éà„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì</p>
            <% else %>
              <%= render @answers %>
            <% end %>
      <%= render 'answers/form', answer: @answer, post: @post %>
    </div>
  </div>
</div>
<%= link_to "Êàª„Çã", posts_path, class: "bg-blue/75 p-4 rounded shadow mb-4 mt-2 hover:bg-blue-30 transition text-dark-gray" %>

<script>
  document.addEventListener("turbo:load", function () {
    // Relationship
    const relationshipSelect = document.getElementById("relationship-select");
    const relationshipField = document.getElementById("custom-relationship-field");

    function toggleRelationshipField() {
      if (relationshipSelect.value === "other_relationship") {
        relationshipField.style.display = "block";
      } else {
        relationshipField.style.display = "none";
      }
    }

    relationshipSelect.addEventListener("change", toggleRelationshipField);
    toggleRelationshipField();

    // Situation
    const situationSelect = document.getElementById("situation-select");
    const situationField = document.getElementById("custom-situation-field");

    function toggleSituationField() {
      if (situationSelect.value === "other_situation") {
        situationField.style.display = "block";
      } else {
        situationField.style.display = "none";
      }
    }

    situationSelect.addEventListener("change", toggleSituationField);
    toggleSituationField();

    // Display Name
    const nameSelect = document.getElementById("name-select");
    const nameField = document.getElementById("custom-name-field");

    function toggleNameField() {
      if (nameSelect.value === "nickname") {
        nameField.style.display = "block";
      } else {
        nameField.style.display = "none";
      }
    }

    nameSelect.addEventListener("change", toggleNameField);
    toggleNameField();
  });
</script>
