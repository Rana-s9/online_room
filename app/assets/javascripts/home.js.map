{
  "version": 3,
  "sources": ["../../javascript/custom/home.js"],
  "sourcesContent": ["document.addEventListener(\"turbo:load\", () => {\n  if (window._threeInitialized) return;\n  window._threeInitialized = true;\n\n  var mixer;\n  const clock = new THREE.Clock();\n  const scene = new THREE.Scene();\n\n  let camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\n  let customCamera1;\n\n  const canvas = document.getElementById('three-canvas');\n  const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });\n  renderer.setSize(canvas.clientWidth, canvas.clientHeight);\n  scene.background = new THREE.Color('#F8F8F0');\n\n  const light = new THREE.DirectionalLight(0xffffff, 1);\n  light.position.set(10, 10, 10).normalize();\n  scene.add(light);\n\n  const ambientLight = new THREE.AmbientLight(0x404040, 1.5);\n  scene.add(ambientLight);\n\n  let dracoLoader = new THREE.DRACOLoader();\n  dracoLoader.setDecoderPath('https://www.gstatic.com/draco/v1/decoders/');\n\n  let loader = new THREE.GLTFLoader();\n  loader.setDRACOLoader(dracoLoader);\n\n  let glbLoaded = false;\n\n  loader.load(\n    '/home.glb',\n    function (gltf) {\n      const model = gltf.scene;\n      model.scale.set(1, 1, 1);\n      scene.add(model);\n      glbLoaded = true;\n\n      mixer = new THREE.AnimationMixer(model);\n      window.mixer = mixer;\n      window.bookAnimationClips = gltf.animations;\n      window.doorAnimationClips = gltf.animations;\n\n      if (gltf.cameras && gltf.cameras.length > 0) {\n        const cameraName = \"1\u30AB\u30E1\";\n        const foundCamera = gltf.cameras.find(cam => cam.name === cameraName);\n        if (foundCamera) {\n          customCamera1 = foundCamera;\n          customCamera1.up.set(0, 1, 0);\n          customCamera1.rotation.y += Math.PI;\n          customCamera1.position.z += 1;\n        }\n      }\n\n      document.getElementById('loading-screen').style.display = 'none';\n    },\n    (xhr) => {\n      const percent = (xhr.loaded / xhr.total * 100).toFixed(0);\n      document.getElementById('loading-progress').textContent = `Loading: ${percent}%`;\n    },\n    function (error) {\n      console.error('', error);\n    }\n  );\n\n  camera.position.z = 5;\n\n  const controls = new THREE.OrbitControls(camera, renderer.domElement);\n  controls.enableDamping = true;\n  controls.dampingFactor = 0.05;\n  controls.screenSpacePanning = false;\n  controls.maxPolarAngle = Math.PI / 2;\n\n  const bookBtn = document.getElementById(\"open-book\");\n  if (bookBtn) {\n    bookBtn.addEventListener(\"click\", (e) => {\n      e.preventDefault();\n\n      const animationNames = [\n        \"BookOpen\", \"Action.004\", \"Action.005\", \"Action.006\", \"Action.007\", \"Action.008\",\n        \"Action.009\", \"Action.010\", \"Action.011\", \"Action.012\", \"Action.013\", \"Action.014\",\n        \"Action.015\", \"Action.016\", \"Action.017\", \"Action.018\", \"Action.001\", \"Action.002\",\n        \"Action\"\n      ];\n\n      if (customCamera1) {\n        customCamera1.aspect = camera.aspect;\n        customCamera1.updateProjectionMatrix();\n        controls.object = customCamera1;\n        camera = customCamera1;\n        scene.add(camera);\n      }\n\n      if (window.mixer && window.bookAnimationClips) {\n        let maxDuration = 0;\n\n        animationNames.forEach(name => {\n          const clip = window.bookAnimationClips.find(c => c.name === name);\n          if (clip) {\n            const action = window.mixer.clipAction(clip);\n            action.reset();\n            action.setLoop(THREE.LoopOnce, 1);\n            action.clampWhenFinished = true;\n            action.play();\n\n            if (clip.duration > maxDuration) {\n              maxDuration = clip.duration;\n            }\n          }\n        });\n\n        setTimeout(() => {\n          window.location.href = bookBtn.dataset.roomPath;\n        }, maxDuration * 1000);\n      } else {\n        window.location.href = bookBtn.dataset.roomPath;\n      }\n    });\n  }\n\n  const spotBtn = document.getElementById(\"open-door\");\n  if (spotBtn) {\n    spotBtn.addEventListener(\"click\", (e) => {\n      e.preventDefault();\n\n      const doorNames = [\n        \"part_key_window.004Action\", \"key_window_hook.003Action\"\n      ];\n\n      if (window.mixer && window.doorAnimationClips) {\n        let maxDuration = 0;\n\n        doorNames.forEach(name => {\n          const clip = window.doorAnimationClips.find(c => c.name === name);\n          if (clip) {\n            const action = window.mixer.clipAction(clip);\n            action.reset();\n            action.setLoop(THREE.LoopOnce, 1);\n            action.clampWhenFinished = true;\n            action.play();\n\n            if (clip.duration > maxDuration) {\n              maxDuration = clip.duration;\n            }\n          }\n        });\n\n        setTimeout(() => {\n          window.location.href = spotBtn.dataset.roomPath;\n        }, maxDuration * 1000);\n      } else {\n        window.location.href = spotBtn.dataset.roomPath;\n      }\n    });\n  }\n\n  function animate() {\n    requestAnimationFrame(animate);\n    controls.update();\n\n    const delta = clock.getDelta();\n    if (mixer) mixer.update(delta);\n\n    renderer.render(scene, camera);\n  }\n\n  animate();\n\n  window.addEventListener('resize', () => {\n    const width = canvas.clientWidth;\n    const height = canvas.clientHeight;\n    renderer.setSize(width, height);\n    camera.aspect = width / height;\n    camera.updateProjectionMatrix();\n  });\n});\n"],
  "mappings": "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",
  "names": []
}
